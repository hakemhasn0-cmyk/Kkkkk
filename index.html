<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>تبرع لإصلاح طرق قرية الشغور</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
/* --- نسختك السابقة من CSS مع تعديلات بسيطة --- */
* { margin:0; padding:0; box-sizing:border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
body { background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); color: #333; line-height:1.6; min-height:100vh; display:flex; flex-direction:column; }
.container { max-width:1200px; margin:0 auto; padding:20px; flex:1; }
header { background: linear-gradient(to right,#2c3e50,#3498db); color:white; padding:30px 0; text-align:center; border-radius:15px; margin-bottom:30px; box-shadow:0 10px 30px rgba(0,0,0,0.15); position:relative; overflow:hidden; }
header h1 { font-size:2.8rem; margin-bottom:15px; position:relative; text-shadow:2px 2px 4px rgba(0,0,0,0.3); }
header p { font-size:1.3rem; max-width:800px; margin:0 auto; position:relative; }
.quran-verse { background: linear-gradient(to right,#27ae60,#2ecc71); padding:25px; border-radius:15px; text-align:center; margin-bottom:30px; font-size:1.6rem; color:white; font-weight:bold; box-shadow:0 8px 25px rgba(39,174,96,0.3); position:relative; overflow:hidden; }
.main-content { display:flex; flex-wrap:wrap; gap:30px; margin-bottom:30px; }
.donation-section { flex:1; min-width:300px; background:white; padding:30px; border-radius:15px; box-shadow:0 10px 30px rgba(0,0,0,0.1); position:relative; }
.section-title { font-size:1.8rem; color:#2c3e50; margin-bottom:25px; padding-bottom:15px; border-bottom:2px solid #3498db; position:relative; }
.currency-selector { display:flex; gap:15px; margin-bottom:20px; }
.currency-btn { flex:1; padding:15px; border:none; border-radius:10px; background:#f8f9fa; color:#555; font-weight:bold; cursor:pointer; transition:all 0.3s; }
.currency-btn.active { background: linear-gradient(to right,#3498db,#2c3e50); color:white; transform:translateY(-3px); box-shadow:0 5px 15px rgba(0,0,0,0.2); }
.form-group { margin-bottom:20px; }
.form-group label { display:block; margin-bottom:10px; font-weight:bold; color:#2c3e50; font-size:1.1rem; }
.form-group input, .form-group textarea { width:100%; padding:15px; border:2px solid #e9ecef; border-radius:10px; font-size:1rem; transition:all 0.3s; }
.form-group input:focus, .form-group textarea:focus { border-color:#3498db; outline:none; box-shadow:0 0 0 3px rgba(52,152,219,0.2); }
.form-group textarea { height:120px; resize:vertical; }
.donate-btn { width:100%; padding:18px; background: linear-gradient(to right,#27ae60,#2ecc71); color:white; border:none; border-radius:10px; font-size:1.3rem; font-weight:bold; cursor:pointer; transition:all 0.3s; }
.donate-btn:hover { transform:translateY(-3px); box-shadow:0 8px 20px rgba(39,174,96,0.4); }
.donors-section { flex:1; min-width:300px; background:white; padding:30px; border-radius:15px; box-shadow:0 10px 30px rgba(0,0,0,0.1); }
.donors-list { max-height:400px; overflow-y:auto; padding:10px; border-radius:10px; background:#f8f9fa; }
.donor-item { padding:20px; border-bottom:1px solid #e9ecef; display:flex; justify-content:space-between; align-items:center; background:white; margin-bottom:15px; border-radius:10px; box-shadow:0 3px 10px rgba(0,0,0,0.05); transition:all 0.3s; }
.donor-info { flex:1; }
.donor-name { font-weight:bold; color:#2c3e50; font-size:1.1rem; }
.donor-amount { font-weight:bold; color:#27ae60; font-size:1.2rem; }
.donor-message { font-size:0.95rem; color:#666; margin-top:8px; }
.donor-date { font-size:0.85rem; color:#888; margin-top:5px; }
.total-donations { background: linear-gradient(to right,#3498db,#2c3e50); color:white; padding:25px; border-radius:15px; text-align:center; margin-bottom:30px; box-shadow:0 8px 25px rgba(0,0,0,0.15); }
.total-donations h2 { font-size:1.5rem; margin-bottom:10px; }
.total-donations p { font-size:2.5rem; font-weight:bold; }
footer { text-align:center; padding:25px; margin-top:40px; color:#6c757d; border-top:1px solid #dee2e6; background:#f8f9fa; }
.empty-state { text-align:center; padding:40px 20px; color:#6c757d; }
.empty-state i { font-size:4rem; margin-bottom:20px; color:#ced4da; }
.empty-state p { font-size:1.2rem; }
@media(max-width:768px){ .main-content{ flex-direction:column; } .share-buttons{ flex-direction:column; } .currency-selector{ flex-direction:column; } }
</style>
</head>
<body>
<div class="container">
<header>
<h1>تبرع لإصلاح طرق قرية الشغور</h1>
<p>ساهم في إصلاح الطرق وتسهيل حياة أهل القرية</p>
</header>

<div class="quran-verse">
"مَّثَلُ الَّذِينَ يُنفِقُونَ أَمْوَالَهُمْ فِي سَبِيلِ اللَّهِ ..."
</div>

<div class="total-donations">
<h2>إجمالي التبرعات</h2>
<p id="total-amount">0 ₺</p>
</div>

<div class="main-content">
<div class="donation-section">
<h2 class="section-title">سجل تبرعك</h2>

<div class="currency-selector">
<button class="currency-btn active" id="try-btn">الليرة التركية (₺)</button>
<button class="currency-btn" id="usd-btn">الدولار الأمريكي ($)</button>
</div>

<div class="form-group">
<label for="amount">مبلغ التبرع</label>
<input type="number" id="amount" placeholder="أدخل المبلغ">
</div>
<div class="form-group">
<label for="name">اسم المتبرع</label>
<input type="text" id="name" placeholder="الاسم الكامل">
</div>
<div class="form-group">
<label for="phone">رقم الهاتف</label>
<input type="tel" id="phone" placeholder="رقم الهاتف">
</div>
<div class="form-group">
<label for="message">رسالة خاصة (اختياري)</label>
<textarea id="message" placeholder="اكتب رسالتك هنا..."></textarea>
</div>

<button class="donate-btn" id="donate-btn">سجل التبرع</button>

</div>

<div class="donors-section">
<h2 class="section-title">قائمة المتبرعين</h2>
<div class="donors-list" id="donors-list">
<div class="empty-state">
<i class="fas fa-hand-holding-heart"></i>
<p>لا توجد تبرعات حتى الآن. كن أول المتبرعين!</p>
</div>
</div>
</div>
</div>
</div>

<footer>
<p>جميع الحقوق محفوظة © 2025 | موقع تبرعات قرية الشغور</p>
</footer>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.25.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.25.0/firebase-firestore-compat.js"></script>

<script>
// --- تهيئة Firebase ---
const firebaseConfig = {
  apiKey: "AIzaSyCUb5ySGCLuNwBlCbZx_VuaDfqMtWno1cs",
  authDomain: "tttr-dbde2.firebaseapp.com",
  projectId: "tttr-dbde2",
  storageBucket: "tttr-dbde2.appspot.com",
  messagingSenderId: "296112669273",
  appId: "1:296112669273:web:ae6f583e15705a688be748",
  measurementId: "G-GP1C50C9E9"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// --- تبديل العملات ---
document.getElementById('try-btn').addEventListener('click',()=>{document.getElementById('try-btn').classList.add('active');document.getElementById('usd-btn').classList.remove('active');});
document.getElementById('usd-btn').addEventListener('click',()=>{document.getElementById('usd-btn').classList.add('active');document.getElementById('try-btn').classList.remove('active');});

// --- إضافة تبرع ---
document.getElementById('donate-btn').addEventListener('click', async function(){
    const amount = document.getElementById('amount').value;
    const name = document.getElementById('name').value;
    const phone = document.getElementById('phone').value;
    const message = document.getElementById('message').value;
    const currency = document.querySelector('.currency-btn.active').id==='try-btn'?'TRY':'USD';

    if(amount && name && phone){
        const donation = {
            name,
            amount: parseInt(amount),
            currency,
            phone,
            message,
            date: firebase.firestore.Timestamp.fromDate(new Date())
        };
        await db.collection("donations").add(donation);
        // مسح الحقول
        document.getElementById('amount').value=''; document.getElementById('name').value=''; document.getElementById('phone').value=''; document.getElementById('message').value='';
    } else { alert('يرجى ملء جميع الحقول المطلوبة'); }
});

// --- عرض التبرعات مباشرة ---
function renderDonation(doc){
    const donorsList=document.getElementById('donors-list');
    const emptyState=document.querySelector('.empty-state');
    if(emptyState) emptyState.remove();
    const donorItem=document.createElement('div');
    donorItem.className='donor-item';
    const data=doc.data();
    donorItem.innerHTML=`
        <div class="donor-info">
            <div class="donor-name">${data.name}</div>
            <div class="donor-amount">${data.amount} ${data.currency==='TRY'?'₺':'$'}</div>
            <div class="donor-date">${new Date(data.date.seconds*1000).toLocaleDateString('ar-EG')}</div>
            ${data.message?`<div class="donor-message">${data.message}</div>`:''}
        </div>
    `;
    donorsList.prepend(donorItem);
}

// --- التحديث المباشر ---
db.collection("donations").orderBy("date","desc").onSnapshot(snapshot=>{
    snapshot.docChanges().forEach(change=>{
        if(change.type==="added"){ renderDonation(change.doc); updateTotal(); }
    });
});

// --- تحديث إجمالي التبرعات ---
async function updateTotal(){
    const snapshot=await db.collection("donations").get();
    let total=0;
    snapshot.forEach(doc=>{
        const data=doc.data();
        total+=data.currency==='TRY'?data.amount:data.amount*20;
    });
    document.getElementById('total-amount').textContent=total.toLocaleString()+' ₺';
}
</script>